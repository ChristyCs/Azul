<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->

<html>
    <head>
        <title>Main Page</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.css" />
        <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script src="https://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>
         <link rel="stylesheet" type="text/css" href="main.css">
    </head>
    <body>
        <!--Main div-->
        <div data-role="page" data-theme="b" style="position:relative;" id="page_Main">
            <br>
            
            <svg width="52%" height="16.5%" 
            style="
            position:absolute;
            padding-top:10%;
            padding-left:24%;
            padding-right:24%;
            left:0px;
            top:0px;">
                <rect x="0px" y="0px" width="100%" height="100%" style="fill:none;stroke:rgb(255, 223, 0);stroke-width:5;fill-opacity:0.1;opacity:0.8;stroke-opacity:0.9">
                Your browser does not support SVG
                </rect>
            </svg>
            <br>
            <h1 class="main-title">Planet</h1>
            <h1 class="sec-title">Runner</h1>
            <a class="ui-btn" id="main_ButtonLogin" 
                style="margin-top: 60px;">Login</a>
            <a class="ui-btn" id="main_ButtonCreate"
                style="margin-top: 13px;">Create Account</a>
            <img src="content/spacedude.gif" alt="spacedude" class="spacedude">
        </div>
        
        <!--Login Div-->
        <div data-role="page" data-theme="b" id="page_Login">
            <div data-role="header" id="login_DivHeader">
                <a class="ui-btn ui-btn-icon-left ui-icon-carat-l" id="login_ButtonBack" >Back</a>
                <h1></h1> <!--"Enter Login Details" -->            
            </div>
            <div data-role="content" id="div_Login" class="ui-content">
                <input name="Name" id="login_TextUserN" type="text" 
                      data-clear-btn="true" placeholder="Name">       
                <input name="Password" id="login_TextUserPW" type="password" 
                       data-clear-btn="true" placeholder="Password">                
                <a class="ui-btn" id="login_ButtonLogin">Login</a>
                <div id="login_DivResult" class="functions" style="text-align: center"></div>
            </div>
        </div>
        
        <!--Create Div-->
        <div data-role="page" data-theme="b" id="page_Create">
            <div data-role="header" id="create_DivHeader">
                <a class="ui-btn ui-btn-icon-left ui-icon-carat-l" id="create_ButtonBack">Back</a>
                <h1></h1> <!--Enter New Details-->
            </div>
            <div data-role="content" id="div_Create" class="ui-content">
                <input name="Name" id="create_TextUserN" placeholder="Name" type="text" 
                       data-clear-btn="false">       
                <input name="Password" id="create_TextUserPW" placeholder="Password" type="password" 
                       data-clear-btn="false">
                <input name="Confirm Password" id="create_TextUserConPW" placeholder="Confirm Password" type="password" 
                       data-clear-btn="false">                
                <a class="ui-btn" id="create_ButtonCreate">Create Account</a>
                <div id="create_DivResult" class="functions" style="text-align: center"></div>
            </div>
        </div> 

        <!--Mission Control Div-->
        <div data-role="page" data-theme="b" id="page_MissionControl_Neptune">
            <!--<div data-role="header" id="missioncontrol_DivHeader">
                <!--<a class="ui-btn ui-btn-icon-left ui-icon-carat-l" id="mission_ButtonBack">Logout</a>
                <h1></h1> <!--"Enter Login Details" 
            </div>
            -->
            <!-- include div and css with information to 
                Please turn your phone to horizontal mode!
            --> 
            <div data-role="content" id="div_Login" class="ui-content">
                <img src="content/mission-bground.png" alt="missionbg" class="mission-bg"/>
                <img src="content/hud.png" alt="missionhud" class="mission-hud"/>
                <img src="content/earth.png" alt="earthplanet" class="mission-earth-planet"/>
                <img src="content/mars.png" alt="earthplanet" class="mission-mars-planet"/>
                <h1 class="mission-planetname">Planet: Neptune</h1>
                <p class="mission-facts-1">Play the Neptune Level to complete the mission</p>
                <!--<p class="mission-facts-1"> Neptune is the most distant planet from the Sun in our solar system and 17 times larger than Earth. The planets blue hue is a result of the methane in the outer atmosphere absorbing the red from the sun's light, allowing the blue to bounce back out. </p>-->
               <!-- <p class="mission-facts-2"> The planet's inner core is made from rock and ice, surrounded by a heavy atmosphere of hydrogen, helium and methane gases. Neptune has fierce supersonic winds, resulting from the extremely dense atmosphere, which keep the planet cold and dark. </p>
                <p class="mission-facts-3"> It has 13 official moons and a planetary ring system consisting of mostly ice and small rocks. </p>
            -->
                <div class="planet-scroll-left-btn"> </div>
                <div class="planet-scroll-right-btn"> </div>
                <div class="ui-btn ui-btn-icon-left ui-icon-carat-l" id="mission_ButtonBack">   Logout</div>
                <div class="fact-scroll-up-btn"> </div>
                <div class="fact-scroll-down-btn"> </div>
                
            </div>
        </div>
        <div data-role="page" data-theme="b" id="page_MissionControl_Uranus">
            <div data-role="content" id="div_Login2" class="ui-content">
                 <img src="content/mission-bground.png" alt="missionbg" class="mission-bg"/>
                <img src="content/hud.png" alt="missionhud" class="mission-hud"/>
                <img src="content/mars.png" alt="earthplanet" class="mission-earth-planet"/>
                <h1 class="mission-planetname">Planet: Uranus</h1>
                <p class="mission-facts-1">Play the Uranus Level to complete the mission</p>
            
               <div class="planet-scroll-left-btn"> </div>
                <div class="planet-scroll-right-btn"> </div>
                <div class="ui-btn ui-btn-icon-left ui-icon-carat-l" id="mission_ButtonBack">Logout</div>
                <div class="fact-scroll-up-btn"> </div>
                <div class="fact-scroll-down-btn"> </div>
            </div> 
        </div>

        <!--Loading Div-->
        <div data-role="page" id="page_Loading">
            <br>
            <br>
            <img src="ajax-loader.gif" alt="loader image" 
                 style="display: block; margin-left: auto;margin-right: auto"/>
        </div>

        <script>
            $(function(){
                
                $.ajaxSetup ({
                    cache: false
                }); 
                //URL used for user authentication and creation
                var URL = "https://rocky-chamber-3053.herokuapp.com";
                
                //Main page div
                var pageMain = "#page_Main";
                var mainButtonLogin = "#main_ButtonLogin";
                var mainButtonCreate = "#main_ButtonCreate";
                
                //Login page div
                var pageLogin = "#page_Login";
                var loginTextUserN = "#login_TextUserN";
                var loginTextUserPW = "#login_TextUserPW";
                var loginButtonBack = "#login_ButtonBack";
                var loginButtonLogin = "#login_ButtonLogin";
                var loginDivResult = "#login_DivResult";
                
                //Create Account page div
                var createLogin = "#page_Create";
                var createTextUserN = "#create_TextUserN";
                var createTextUserPW = "#create_TextUserPW";
                var createTextUserConPW = "#create_TextUserConPW";
                var createButtonCreate = "#create_ButtonCreate";
                var createButtonBack = "#create_ButtonBack";
                var createDivResult = "#create_DivResult";
                
                //Loading page div
                var pageLoading = "#page_Loading";                               
                //Mission Control div
                var logoutButtonBack = "#mission_ButtonBack";
                var planetLeftButton = "planet-scroll-left-btn";
                var planetRightButton = "planet-scroll-right-btn";
                var factUpButton = "fact-scroll-up-btn";
                var factDownButton = "fact-scroll-down-btn";


                //Button Click functions
                //Main Buttons


                $(mainButtonLogin).on('click', function(){
                    $.mobile.changePage("#page_Login", { transition: "slide", 
                        reverse: false, changeHash: false });
                });                
                $(mainButtonCreate).on('click', function(){
                    $.mobile.changePage("#page_Create", { transition: "slide", 
                        reverse: false, changeHash: false });
                });
                
                //Login buttons
                $(logoutButtonBack).on('click', function(){
                    $.mobile.changePage("#page_Main", { transition: "slide", 
                        reverse: true, changeHash: false });
                });

                $(loginButtonBack).on('click', function(){
                    $(loginDivResult).html("");
                    $.mobile.changePage("#page_Main", { transition: "slide", 
                        reverse: true, changeHash: false });
                });
                
                $(loginButtonLogin).on('click', function(){

                    var jsonUrl = URL+"/login";
                    var hasName = $(loginTextUserN).val();
                    var hasPass = $(loginTextUserPW).val();
                    if(hasName && hasPass){
                        var userName = $(loginTextUserN).val();
                        var userPassword = $(loginTextUserPW).val();
                        var userDetails = {"username": userName, "password":userPassword};                        
                        $.mobile.changePage("#page_Loading", { transition: "none", 
                            reverse: false, changeHash: false });

/*
                        $( window ).on( "orientationchange", function( event ) {
  $( "#orientation" ).text( "This device is in " + event.orientation + " mode!" );
});
*/
                        
                        $.post(jsonUrl, userDetails)
                                .success(function(data){
                                    console.log("Success");
                                })
                                .error(function(data){
                                    console.log("Error occured with login");
                                    var htmlVal = "<p><b>Wrong User Name or Password</b><p>";
                                    $(loginDivResult)
                                            .css("color","red")
                                            .css("font-size","0.8em")
                                            .html(htmlVal);
                                    $.mobile.changePage("#page_Login", { transition: "none", 
                                        reverse: false, changeHash: false });
                                });
 
                        $.mobile.changePage("#page_MissionControl_Neptune", { 
                         reverse: false, changeHash: false });

                    }else{
                        var htmlVal = "<p><b>Please enter User Name and Password</b><p>";
                        $(loginDivResult)
                                .css("color","red")
                                .css("font-size","0.8em")
                                .html(htmlVal);
                    }
                });
                
                //Create buttons
                $(createButtonBack).on('click', function(){
                   $.mobile.changePage("#page_Main", { transition: "slide", 
                        reverse: true, changeHash: false });
                   $(createDivResult).html("");
                });
                
                $(createButtonCreate).on('click', function(){
                   var jsonUrl = URL+"/create";
                   var hasName = $(createTextUserN).val();
                   var hasPass = $(createTextUserPW).val();
                   var hasConPass = $(createTextUserConPW).val();
                   
                   if(hasName && hasPass && hasConPass){
                       var userName = $(createTextUserN).val();
                       var userPass = $(createTextUserPW).val();
                       var userConPass = $(createTextUserConPW).val();
                       if(!(userPass === userConPass)){
                           var htmlVal = "<p><b>Passwords Do Not Match</b></p>";
                           $(createDivResult)
                                .css("color","red")
                                .css("font-size","0.8em")
                                .html(htmlVal);                           
                       }else{
                           $.mobile.changePage("#page_Loading", { transition: "none", 
                                reverse: false, changeHash: false });
                           var userDetails = {"username":userName,"password":userPass};
                           $.post(jsonUrl, userDetails)
                                   .success(function(data){
                                       console.log(data);
                                   })
                                   .error(function(data){
                                       console.log(data.responseText);
                                       var htmlVal = "<p><b>User Name Already in Use</b></p>";
                                       $(createDivResult)
                                                .css("color","red")
                                                .css("font-size","0.8em")
                                                .html(htmlVal);
                                       $.mobile.changePage("#page_Create", { transition: "none", 
                                            reverse: false, changeHash: false });
                                   });
                           
                       }
                   }else{
                       var htmlVal = "<p><b>Please Enter Required Details</b></p>";
                       $(createDivResult)
                                .css("color","red")
                                .css("font-size","0.8em")
                                .html(htmlVal);
                   }
                });
                
            });
            
        </script>
    </body>
</html>
